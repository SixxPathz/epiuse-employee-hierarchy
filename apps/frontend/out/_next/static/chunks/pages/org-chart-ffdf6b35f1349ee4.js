(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{6753:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/org-chart",function(){return s(5295)}])},5295:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var r=s(5893),a=s(7294),l=s(9008),n=s.n(l),i=s(1163),c=s(2637),d=s(8551);let o=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}),m=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))}),x=a.forwardRef(function(e,t){let{title:s,titleId:r,...l}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),s?a.createElement("title",{id:r},s):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))});var h=s(3950),u=s(3069),g=s(8999);function p(){let[e,t]=(0,a.useState)(""),[s,l]=(0,a.useState)(new Set),[n,i]=(0,a.useState)("tree"),{data:c,isLoading:p}=(0,d.a)({queryKey:["hierarchy"],queryFn:async()=>(await g.Z.get("/employees/hierarchy/tree")).data.hierarchy}),f=e=>{let t=new Set(s);t.has(e)?t.delete(e):t.add(e),l(t)},j=(e,t)=>{if(!t)return!0;let s=t.toLowerCase();return!!(e.name.toLowerCase().includes(s)||e.position.toLowerCase().includes(s)||e.email.toLowerCase().includes(s)||e.employeeNumber.toLowerCase().includes(s))||!!e.children&&e.children.some(e=>j(e,t))};if(p)return(0,r.jsx)("div",{className:"card",children:(0,r.jsx)("div",{className:"card-body",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-8 bg-gray-200 rounded mb-4"}),(0,r.jsx)("div",{className:"h-64 bg-gray-200 rounded"})]})})});let N=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!j(t,e))return null;let l=t.children&&t.children.length>0,n=s.has(t.id),i=24*a;return(0,r.jsxs)("div",{className:"mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center p-3 bg-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200",style:{marginLeft:"".concat(i,"px")},children:[l&&(0,r.jsx)("button",{onClick:()=>f(t.id),className:"mr-2 p-1 rounded hover:bg-gray-100 flex-shrink-0",children:n?(0,r.jsx)(o,{className:"h-4 w-4 text-gray-500"}):(0,r.jsx)(m,{className:"h-4 w-4 text-gray-500"})}),a>0&&(0,r.jsx)("div",{className:"absolute w-6 h-px bg-gray-300",style:{left:"".concat(i-12,"px")}}),(0,r.jsx)("div",{className:"flex-shrink-0 mr-3",children:(0,r.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:t.name.split(" ").map(e=>e[0]).join("").slice(0,2)})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900 truncate",children:t.name}),0===a&&(0,r.jsx)(x,{className:"h-4 w-4 text-amber-500"})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600 truncate",children:t.position}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 mt-1 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["ID: ",t.employeeNumber]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{className:"truncate",children:t.email})]})]}),l&&(0,r.jsx)("div",{className:"flex-shrink-0 ml-2",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,r.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),t.children.length]})})]}),l&&(n||!e)&&(0,r.jsx)("div",{className:"mt-2",children:t.children.map(e=>N(e,a+1))})]},t.id)},y=e=>(0,r.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow duration-200",children:(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:e.name.split(" ").map(e=>e[0]).join("").slice(0,2)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 truncate",children:e.position}),(0,r.jsxs)("div",{className:"flex items-center space-x-3 mt-1 text-xs text-gray-500",children:[(0,r.jsxs)("span",{children:["ID: ",e.employeeNumber]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsx)("span",{className:"truncate",children:e.email})]})]}),e.children&&e.children.length>0&&(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,r.jsx)(h.Z,{className:"h-3 w-3 mr-1"}),e.children.length," direct reports"]})})]})},e.id),v=e=>{let t=[e];return e.children&&e.children.forEach(e=>{t.push(...v(e))}),t},b=c?v(c):[],w=b.filter(t=>j(t,e));return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"card",children:[(0,r.jsxs)("div",{className:"card-header",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Organization Chart"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Interactive company hierarchy with search"})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>i("tree"),className:"px-3 py-2 rounded-md text-sm font-medium ".concat("tree"===n?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"),children:"Tree View"}),(0,r.jsx)("button",{onClick:()=>i("compact"),className:"px-3 py-2 rounded-md text-sm font-medium ".concat("compact"===n?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"),children:"List View"})]})]}),(0,r.jsxs)("div",{className:"mt-4 relative",children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,r.jsx)(u.Z,{className:"h-5 w-5 text-gray-400"})}),(0,r.jsx)("input",{type:"text",placeholder:"Search employees by name, position, email, or ID...",value:e,onChange:e=>t(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,r.jsx)("div",{className:"card-body",children:c?(0,r.jsxs)("div",{className:"min-h-96",children:["tree"===n?(0,r.jsx)("div",{className:"space-y-2",children:N(c)}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map(e=>y(e))}),e&&0===w.length&&(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(u.Z,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No results found"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search terms"})]})]}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(x,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No organizational data available"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Contact your administrator to set up the organizational structure"})]})})]}),c&&(0,r.jsx)("div",{className:"card",children:(0,r.jsxs)("div",{className:"card-body",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Organization Statistics"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:b.length}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Total Employees"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-green-600",children:b.filter(e=>e.children&&e.children.length>0).length}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Managers"})]}),(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:Math.max(...b.map(e=>v(e).length-1))}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Max Team Size"})]})]})]})})]})}function f(){let[e,t]=(0,a.useState)(null),[s,l]=(0,a.useState)(!0),d=(0,i.useRouter)();return((0,a.useEffect)(()=>{let e=localStorage.getItem("auth_token"),s=localStorage.getItem("user");if(!e||!s){d.push("/auth/login");return}try{let e=JSON.parse(s);t(e)}catch(e){console.error("Error parsing user data:",e),d.push("/auth/login")}finally{l(!1)}},[d]),(0,a.useEffect)(()=>{let e=e=>{t(e.detail)};return window.addEventListener("userProfileUpdated",e),()=>{window.removeEventListener("userProfileUpdated",e)}},[]),s)?(0,r.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-company-navy"})}):e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n(),{children:[(0,r.jsx)("title",{children:"Organization Chart - EPI-USE Nexus"}),(0,r.jsx)("meta",{name:"description",content:"View your organization's hierarchy"})]}),(0,r.jsx)(c.Z,{user:e,children:(0,r.jsx)(p,{})})]}):null}},3069:function(e,t,s){"use strict";var r=s(7294);let a=r.forwardRef(function(e,t){let{title:s,titleId:a,...l}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},l),s?r.createElement("title",{id:a},s):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))});t.Z=a}},function(e){e.O(0,[66,814,134,666,393,888,774,179],function(){return e(e.s=6753)}),_N_E=e.O()}]);